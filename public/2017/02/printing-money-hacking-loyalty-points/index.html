<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Printing money - hacking loyalty points - Jef Claes</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Printing money - hacking loyalty points">
<meta itemprop="description" content="At work, we&rsquo;ve all grown quite vigilant when it comes to customers trying to cheat the system. A necessary trait when working in a domain where money flows back and forth and customers are always trying to find an edge that will turn the tables.
While most tend to leave this mindset at work, one colleague in particular, is always probing, trying to find cracks in the surface of everyday models.">
<meta itemprop="datePublished" content="2017-02-12T00:20:00&#43;01:00" />
<meta itemprop="dateModified" content="2017-02-12T00:20:00&#43;01:00" />
<meta itemprop="wordCount" content="626">



<meta itemprop="keywords" content="opinion," /><meta property="og:title" content="Printing money - hacking loyalty points" />
<meta property="og:description" content="At work, we&rsquo;ve all grown quite vigilant when it comes to customers trying to cheat the system. A necessary trait when working in a domain where money flows back and forth and customers are always trying to find an edge that will turn the tables.
While most tend to leave this mindset at work, one colleague in particular, is always probing, trying to find cracks in the surface of everyday models." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jefclaes.be/2017/02/printing-money-hacking-loyalty-points/" />
<meta property="article:published_time" content="2017-02-12T00:20:00+01:00" />
<meta property="article:modified_time" content="2017-02-12T00:20:00+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Printing money - hacking loyalty points"/>
<meta name="twitter:description" content="At work, we&rsquo;ve all grown quite vigilant when it comes to customers trying to cheat the system. A necessary trait when working in a domain where money flows back and forth and customers are always trying to find an edge that will turn the tables.
While most tend to leave this mindset at work, one colleague in particular, is always probing, trying to find cracks in the surface of everyday models."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://jefclaes.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://jefclaes.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://jefclaes.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://jefclaes.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
		<div class="avatar">
			<a href="https://jefclaes.be/">
				<img src="https://image.freepik.com/free-vector/young-man-head-with-beard-avatar-character_24877-36786.jpg" alt="Jef Claes" />
			</a>
		</div>
	
	<h1 class="site-title"><a href="https://jefclaes.be/">Jef Claes</a></h1>
	<div class="site-description"><p>On software and life</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/jefclaes" title="Github"><i data-feather="github"></i></a></li><li><a href="https://twitter.com/jefclaes" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://www.linkedin.com/in/jefclaes" title="LinkedIn"><i data-feather="linkedin"></i></a></li><li><a href="http://feed.jefclaes.be" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/post">All posts</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">12</span>
							<span class="rest">Feb 2017</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Printing money - hacking loyalty points</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>At work, we&rsquo;ve all grown quite vigilant when it comes to customers
trying to cheat the system. A necessary trait when working in a domain
where money flows back and forth and customers are always trying to find
an edge that will turn the tables.</p>
<p>While most tend to leave this mindset at work, one colleague in
particular, is always probing, trying to find cracks in the surface of
everyday models. Years of practice have made him exceptionally good at
it too. When you want more than a shallow review of your design, you go
see him.</p>
<p>I happened to be a part of his last quest, in which we reverse
engineered a case of security by obscurity involving a large supermarket
chain.</p>
<p>A bit of backstory first. This supermarket - as many others - offers a
loyalty program. In return for your data, you earn one point per two
euros spent. As soon as you&rsquo;ve saved up 500 points, you get a 5 euro
coupon which you can use to get a discount or to buy an item in their
loyalty shop. To identify yourself, you receive a card which you show to
the cashier on checkout or which you scan yourself when using the
self-checkout. When you forgot your card in the car or at home, they
print a code on the receipt. This allows you to claim your points
afterwards by handing it to the cashier, or again by scanning it
yourself at the self-checkout.</p>
<p>In this example, we purchased something small without using our loyalty
card. The item cost less than four euros, earning us one meager loyalty
point. If you take a closer look at the ticket, you can see the amount
of points being repeated at the tail of the barcode.</p>
<p><a href="/post/images/2017-02-12-printing-money-hacking-loyalty-points-ticket.png"><img src="/post/images/thumbnails/2017-02-12-printing-money-hacking-loyalty-points-ticket.png" alt=""></a></p>
<p>If you&rsquo;re familiar with the anatomy of some of the established barcode
standards, you might notice they&rsquo;re using the UPC symbology to encode
loyalty points.</p>
<p><a href="/post/images/2017-02-12-printing-money-hacking-loyalty-points-upc.gif"><img src="/post/images/thumbnails/2017-02-12-printing-money-hacking-loyalty-points-upc.gif" alt=""></a></p>
<p>After proving the manufacturer code was connected to the store the
ticket was printed at - by purchasing multiple products from different
branches, we figured we could just go ahead and forge our own loyalty
points. A quick Google search and a printer were all the tools we
needed.</p>
<p><a href="/post/images/2017-02-12-printing-money-hacking-loyalty-points-forge.PNG"><img src="/post/images/thumbnails/2017-02-12-printing-money-hacking-loyalty-points-forge.PNG" alt=""></a></p>
<p>So we first purchased two products on two different days. This gave us a
ticket worth one point and another one worth two points. We printed our
own barcode worth three points, and claimed it at the self-checkout. We
weren&rsquo;t stopped by security on our way out, and the points were credited
to our points wallet, so I guess it was a successful experiment.</p>
<p>To be fair, if it wasn&rsquo;t for the self-checkout option, it would be much
harder to get away with this. If we had to hand over our ticket to a
human, we would have needed to counterfeit a lot more than just the
barcode. There are reasons it&rsquo;s so incredibly hard to print fake money. </p>
<p>The system used is quite simple; both from a customer perspective as a
technical perspective. It&rsquo;s a lightweight stateless model which should
hardly require any maintenance.</p>
<p>If you wanted to make this system more secure - not necessarily bullet
proof, I can think of two obvious options:</p>
<ul>
<li>Leave the validation of points to humans. I&rsquo;m not sure how hard it would be to make a high quality copy of a ticket with lots of points on it. </li>
<li>Spawn a new state machine identified by a random token each time you hand out points. This state machine allows points to be claimed and to expire. </li>
</ul>
<p>Please chime in if you know of battle-tested models for this type of
functionality. </p>
<p>Closing off, we didn&rsquo;t do any harm during our research: we didn&rsquo;t take
more than we paid for.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/opinion">opinion</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2017  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-6239073-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
